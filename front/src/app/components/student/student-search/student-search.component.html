<!-- Centered container keeps the grid framed on large screens -->
<div class="page-container">
  <div class="content-container">
    <mat-toolbar class="view-toggle-toolbar">
      <button mat-button
              [class.active]="viewMode === 'card'"
              (click)="changeViewMode('card')">
        <mat-icon>view_comfy</mat-icon>
        Grid
      </button>
      <button mat-button
              [class.active]="viewMode === 'list'"
              (click)="changeViewMode('list')">
        <mat-icon>view_list</mat-icon>
        List
      </button>
    </mat-toolbar>

    <ng-container *ngIf="!isLoading && filteredStudents.length > 0; else loadingOrEmptyState">
      <!-- Shared responsive grid/list wrapper. cards-container drives the adaptive columns -->
      <div class="student-view"
           [ngClass]="viewMode === 'card' ? 'cards-container card-view' : 'list-view'">
        <ng-container *ngIf="viewMode === 'card'">
          <app-student-card *ngFor="let student of currentPageStudents" [student]="student" class="fade-in"></app-student-card>
        </ng-container>
        <ng-container *ngIf="viewMode === 'list'">
          <app-student-list-item *ngFor="let student of currentPageStudents" [student]="student" class="fade-in"></app-student-list-item>
        </ng-container>
      </div>
    </ng-container>

    <ng-template #loadingOrEmptyState>
      <div *ngIf="isLoading" class="loading-container">
        <mat-spinner></mat-spinner>
      </div>
      <div *ngIf="!isLoading && filteredStudents.length === 0" class="empty-state">
        <mat-icon class="empty-icon">person_off</mat-icon>
        <p>Aucun étudiant trouvé.</p>
      </div>
    </ng-template>


    <!-- Paginator stays aligned with the content container -->
    <mat-paginator [length]="totalStudents"
                   [pageSize]="pageSize"
                   [pageSizeOptions]="pageSizeOptions"
                   (page)="changePage($event)">
    </mat-paginator>
  </div>
</div>
