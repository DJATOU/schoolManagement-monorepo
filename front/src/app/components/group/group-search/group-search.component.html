<div class="page-header">
  <app-list-header [count]="totalGroups" [entityName]="'groups'" [filterLabel]="'Show active only'"
    (filterChange)="onActiveFilterChange($event)">
  </app-list-header>

  <app-view-toggle [viewMode]="viewMode" (viewModeChange)="changeViewMode($event)">
  </app-view-toggle>
</div>

<ng-container *ngIf="!isLoading && filteredGroups.length > 0; else loadingOrEmptyState">
  <div class="cards-section">
    <div class="group-view" [ngClass]="viewMode === 'card' ? 'cards-grid' : 'list-view'">
      <ng-container *ngIf="viewMode === 'card'">
        <app-group-card *ngFor="let group of currentPageGroups" [group]="group" [levels]="levels"
          [groupTypes]="groupTypes">
        </app-group-card>
      </ng-container>
      <ng-container *ngIf="viewMode === 'list'">
        <app-group-list *ngFor="let group of currentPageGroups" [group]="group" [levels]="levels"
          [groupTypes]="groupTypes">
        </app-group-list>
      </ng-container>
    </div>

    <div class="paginator-wrapper">
      <mat-paginator [length]="totalGroups" [pageSize]="pageSize" [pageSizeOptions]="pageSizeOptions"
        (page)="changePage($event)">
      </mat-paginator>
    </div>
  </div>
</ng-container>

<ng-template #loadingOrEmptyState>
  <div *ngIf="isLoading" class="loading-container">
    <mat-spinner></mat-spinner>
  </div>
  <div *ngIf="!isLoading && filteredGroups.length === 0" class="empty-state">
    <mat-icon class="empty-icon">group_off</mat-icon>
    <p>Aucun groupe trouv√©.</p>
  </div>
</ng-template>